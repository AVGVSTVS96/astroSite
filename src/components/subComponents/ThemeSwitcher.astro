---
import DropdownMenu from './DropdownMenu.astro';
import type { HTMLAttributes } from 'astro/types';

type Props = HTMLAttributes<'div'>;

const themeOptions = [
  { name: 'Sky', url: '#sky' },
  { name: 'Cyan', url: '#cyan' },
  { name: 'Teal', url: '#teal' },
  { name: 'Emerald', url: '#emerald' },
  { name: 'Violet', url: '#violet' },
  { name: 'Fuchsia', url: '#fuchsia' },
  { name: 'Amber', url: '#amber' },
];
---

<div class="theme-switcher">
  <DropdownMenu
    name="color"
    links={themeOptions}
    showCaret={true}
    icon={true}
  />
</div>

<script is:inline>
  const changeTheme = (newTheme) => {
    document.documentElement.removeAttribute('data-theme');
    document.documentElement.setAttribute('data-theme', newTheme);
    localStorage.setItem('themeSwitcher', newTheme);
  };

  const currentTheme = localStorage.getItem('themeSwitcher') || 'sky';
  changeTheme(currentTheme);

  document.addEventListener('DOMContentLoaded', () => {
    document
      .querySelectorAll('.theme-switcher .dropdown-content a')
      .forEach((link) => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          const theme = e.target.getAttribute('href').substring(1); // Extract theme name from href
          changeTheme(theme);
        });
      });
  });
</script>
<style is:global>
  [data-icon='color'] {
    @apply text-accent-400;
  }
</style>