---
const { class: className, heading, isSubheading, level = 0 } = Astro.props;
import type { MarkdownHeading } from 'astro';
import { Icon } from 'astro-icon/components';

export interface Heading extends MarkdownHeading {
  subheadings: Heading[];
}

interface Props {
  class?: string;
  isSubheading?: boolean;
  level?: number;
  heading: Heading;
}
---

<li class={className}>
  <a
    href={'#' + heading.slug}
    class="group hover:text-foreground mt-0 flex items-start no-underline transition-colors duration-200">
    <Icon
      name="sideCaret"
      size={13}
      class:list={[
        'mx-1 mt-1 shrink-0 transition-all duration-200',
        isSubheading ? '' : 'hidden',
        level === 2
          ? 'stroke-muted-foreground/60 group-hover:stroke-muted-foreground/80'
          : 'stroke-muted-foreground/40 group-hover:stroke-muted-foreground/60',
      ]}
      title="caret-icon"
    />
    {heading.text}
  </a>
  {
    heading.subheadings.length > 0 && (
      <ul class={`${isSubheading ? 'ml-2' : ''} my-0 list-none px-0`}>
        {heading.subheadings.map((subheading: Heading) => (
          <Astro.self
            class="px-0"
            heading={subheading}
            isSubheading={true}
            level={level + 1}
          />
        ))}
      </ul>
    )
  }
</li>

<style>
  li:has(.active) > a {
    color: var(--color-foreground);
    font-weight: 500;
    opacity: 0.9;
  }

  :root.dark li:has(.active) > a {
    color: var(--color-foreground);
    opacity: 0.85;
  }

  a {
    color: var(--color-muted-foreground);
  }

  a:hover {
    color: var(--color-foreground);
  }
</style>